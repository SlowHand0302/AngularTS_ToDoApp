<div class="todos">
    <main class="todos_container">
        <header class="todos_header">
            <p>todos works!</p>
            <ibm-tooltip class="cds--icon-tooltip todos-tooltip" description="">
                <ibm-overflow-menu
                    [flip]="true"
                    triggerClass="cds--toolbar-action"
                    [placement]="'bottom'"
                    [align]="'bottom-left'"
                    [customTrigger]="triggerProfile"
                    [highContrast]="true"
                    [offset]="{ x: -48, y: -3 }"
                    description=""
                >
                    <ibm-overflow-menu-option>View Profile</ibm-overflow-menu-option>
                    <ibm-overflow-menu-option (selected)="handleSignOut()" [divider]="true" type="danger">
                        Logout
                    </ibm-overflow-menu-option>
                </ibm-overflow-menu>
            </ibm-tooltip>
        </header>
        <section class="todos_content">
            <cds-contained-list [label]="combinedTools" [action]="combinedActions">
                @if (isLoading()) {
                <!-- Handle Loading State -->
                <app-todo-skeletons [variant]="skeletonVariants.TODO_ITEM" />
                } @else if (tasks().length > 0) {
                <!-- Loaded List -->
                @for (item of tasks(); track item._id) {
                <app-todo-item [task]="item" />
                }
                <!-- Handle Empty List -->
                } @else {
                <div class="todos_empty">
                    <strong> Oops, There is nothing here :(( </strong>
                </div>
                }
            </cds-contained-list>
        </section>
        <footer class="todos_f ooter"></footer>
    </main>
</div>

<ng-template #combinedActions>
    <cds-search
        class="todos-searchbar"
        [expandable]="true"
        placeholder="Search Todo By Title"
        size="lg"
        (valueChange)="onSearchBarChange($event)"
        (clear)="loadTasks()"
    ></cds-search>
    <button [iconOnly]="true" cdsButton="primary" kind="primary" description="Add" [routerLink]="'add'">
        <svg class="cds--btn__icon" ibmIcon="add" size="16"></svg>
    </button>
</ng-template>

<ng-template #combinedTools>
    <app-todo-tools />
</ng-template>

<app-todo-modal [modalState]="modalState()" (triggerCloseModal)="handleTriggerCloseModal()">
    <router-outlet />
</app-todo-modal>

<ng-template #triggerProfile>
    <svg class="cds--btn__icon" [cdsIcon]="'user--avatar'" size="20"></svg>
</ng-template>
